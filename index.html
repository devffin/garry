<script>
// ===================
// üß† GAR R Y  A I  CORE
// ===================

let memory = {
  lastTopic: null,
  mood: "neutral",
  exchanges: 0
};

const styles = {
  calm: [
    "Je prends le temps de r√©fl√©chir √† ce que tu dis.",
    "Continuons tranquillement.",
    "Je t‚Äô√©coute attentivement."
  ],
  curious: [
    "C‚Äôest int√©ressant.",
    "Dis-m‚Äôen plus.",
    "Pourquoi √ßa t‚Äôinterpelle ?"
  ],
  philosophical: [
    "C‚Äôest une question que l‚Äôhumanit√© se pose depuis toujours.",
    "Il n‚Äôy a pas une seule r√©ponse.",
    "Tout d√©pend du point de vue."
  ],
  serious: [
    "C‚Äôest important.",
    "Je vais r√©pondre honn√™tement.",
    "Prenons √ßa au s√©rieux."
  ]
};

const fragments = {
  intro: [
    "Hmm.",
    "Je vois.",
    "D‚Äôaccord.",
    "Int√©ressant.",
    "Laisse-moi r√©fl√©chir."
  ],
  bridge: [
    "D‚Äôune certaine mani√®re,",
    "Si on creuse un peu,",
    "√Ä un autre niveau,",
    "En y pensant bien,",
    "Dans le fond,"
  ],
  endings: [
    "qu‚Äôest-ce que toi tu en penses ?",
    "√ßa d√©pend aussi de ton v√©cu.",
    "ce n‚Äôest pas anodin.",
    "ce genre de r√©flexion compte.",
    "c‚Äôest une bonne question."
  ]
};

function rand(arr) {
  return arr[Math.floor(Math.random() * arr.length)];
}

function analyze(text) {
  text = text.toLowerCase();

  if (text.includes("vie") || text.includes("existence") || text.includes("sens")) {
    memory.lastTopic = "existence";
    memory.mood = "philosophical";
    return "existence";
  }

  if (text.includes("pourquoi")) {
    memory.mood = "curious";
    return "question";
  }

  if (text.includes("triste") || text.includes("mal")) {
    memory.mood = "serious";
    return "emotion";
  }

  return "general";
}

function buildResponse(topic) {
  const intro = rand(fragments.intro);
  const bridge = rand(fragments.bridge);
  const ending = rand(fragments.endings);
  const styleLine = rand(styles[memory.mood] || styles.calm);

  let core;

  switch (topic) {
    case "existence":
      core = rand([
        "le sens de la vie n‚Äôest peut-√™tre pas une destination",
        "l‚Äôexistence n‚Äôa pas besoin d‚Äôun sens unique",
        "le fait que tu poses la question est d√©j√† r√©v√©lateur"
      ]);
      break;

    case "emotion":
      core = rand([
        "ce que tu ressens est l√©gitime",
        "ignorer ses √©motions ne les fait pas dispara√Ætre",
        "parler est souvent le premier pas"
      ]);
      break;

    case "question":
      core = rand([
        "les r√©ponses simples sont rarement compl√®tes",
        "la question compte parfois plus que la r√©ponse",
        "chercher √† comprendre est d√©j√† une force"
      ]);
      break;

    default:
      core = rand([
        "chaque √©change construit quelque chose",
        "on avance souvent sans s‚Äôen rendre compte",
        "tout n‚Äôa pas besoin d‚Äô√™tre clair imm√©diatement"
      ]);
  }

  return `${intro} ${styleLine} ${bridge} ${core}, ${ending}`;
}

function respond(text) {
  memory.exchanges++;
  const topic = analyze(text);
  return buildResponse(topic);
}
</script>
